# 共轭梯度法

## 共轭

### 定义

> 共轭定义为
>
> $$p_0^TAp_1=0 $$称为$p_0,p_1$关于$A$共轭。

### 性质

> 1. **线性无关的条件：** 关于对称正定的矩阵的一族共轭向量**线性无关**
>
> 2. 在$R^n$中，相互共轭的向量组的向量个数不超过$n$

## 共轭梯度法的思想

还是优先考虑二次函数的优化。

对于空间$R^n$中，任何一个向量都可以被$n$个线性无关的向量线性表示。那么用一族共轭向量就可以直接表示出残差。而二次函数的优化问题是可以精确求解的。这就是精确方法。很容易理解，这里不细说。

这样的思想就带来了**子空间扩展定理**

> 对于一族非零向量$d_0,d_1,\dots, d_{n-1}$关于矩阵$Q$相互共轭。$\forall x_0\in R^n $，设迭代格式$$x_{k+1}=x_k+\alpha_kd_k $$，其中步长有精确搜索计算。那么$$\nabla f(x_{k+1})^Td_j=0,\quad j=0,\dots,k $$
>
> 且$x_{k+1 } $是$f$在线性流形$$S_k=\{x=x_0+\sum_{i=0}^k\beta_id_i|\beta_i\in R,i=0,\dots,k \} $$中的极小点，特别地，$x_n=x^*=-Q^{-1}q$是唯一的极小点。

子空间扩展定理表明共轭方向法具有二次终止性。

证明方法略，可以看[PPT](../ppt/最优化第13讲%20%20%20共轭梯度法.pdf)。

这个定理讲的就是说共轭梯度法得到的下降方向关于更小维度的梯度都是**正交的**。


## 共轭方向的计算

可使用类似Gram-Schmit正交化的过程进行

> 给出一族线性无关向量组$p_0,\dots,p_{n-1}\in R^n$
> 计算$$d_{k+1}=p_{k+1}-\sum_{j=0}^k\frac{d_j^TQp_{k+1}}{d_j^TQp_j}d_j $$

# CG算法

根据上面的思想，就形成了CG算法。

考虑二次函数$$f(x)=\frac{1}{2}x^TAx+bx+c $$

> $$r_k=Ax_k$$$$\beta_k=\frac{r_k^TAp_{k-1}}{p_{k-1}^TAp_{k-1}} $$$$p_k=-r_k+\beta_kp_{k-1} $$$$\alpha_k=-\frac{r_k^Tp_k}{p_k^TAp_k} $$$$x_{k+1}=x_k+\alpha_kp_k $$

尽管如此，其实实际上更常用的是另外的方法。这里不写了。

## 收敛性

如果矩阵$A$有$r$个不同的特征值，那么迭代最多$r$步得到解。

另外由$$\Vert x_k-x^*\Vert_A\leq 2(\frac{\sqrt{\kappa(A)}-1}{\sqrt{\kappa(A)}+1})^k\Vert x_0-x^*\Vert_A $$

如果矩阵的条件数很高，会导致计算实际上可能收敛很慢。

此时需要预处理，也就是对空间做正交变换。

# 总结

1. 共轭梯度法不需要存储矩阵，存储小，计算简单，适合大规模问题。
2. 至多$n$步收敛到最优解。预处理还可以加速。
3. 采用精确搜索，而且初始方向必须选最速下降方向。

> 这里的共轭梯度法没讲完，直接看[下一节](14-共轭梯度法2.md)为续。


