# 共轭梯度法续

算法的过程

> 首先取$d_0=-\nabla f(x_0)$
>
> 后续迭代中，取负梯度与前一搜索方向的现形组合作为方向。$$d_k=-\nabla f(x_k)+\beta_kd_{k-1} $$，其中$\beta_k$是待定系数。
>
> $$x_{k+1}=x_k+\alpha_kd_k $$
>
> 由于$\alpha_k$是精确搜索得到，因此$$\nabla f(x_{k+1})^Td_k=0 $$
>
> 令$d_{k-1}^TQd_k=0 $，因此有$$\beta_k=\frac{d_{k-1}^TQ\nabla f(x_k)}{d_{k-1}^TQd_{k-1}} $$

## HS共轭梯度法

为了避免存储黑塞矩阵，需要得到$Qd_{k-1}$的表达式。

对于二次函数(或者近似看成二次函数)，由于$$\nabla f(x_k)=\nabla f(x_{k-1})+\alpha_{k-1}Qd_{k-1} $$，可以推出$$Q d_{k-1}=\frac{\nabla f(x_k)-\nabla f(x_{k-1})}{\alpha_{k-1}} $$

代入整理有$$\beta_k^{HS}=\frac{\nabla f(x_k)^T[\nabla f(x_k)-\nabla f(x_{k-1})]}{d_{k-1}^T[\nabla f(x_k)-\nabla f(x_{k-1})]} $$

> HS算法关于严格凸二次函数的共轭性质：
>
> 设$\{x_k \}$表示采用精确搜索得到的HS算法求解问题缩产生的点列，则向量组$\{d_i \} $关于黑塞矩阵$Q$相互共轭，而且有$$\nabla f(x_k)^Td_j=0,\quad \nabla f(x_k)^T\nabla f(x_j)=0,\quad \forall j<k $$
>
> 这就是共轭梯度法的一个最本质的定理。
>
> 该定理使用数学归纳法来证明。
>
> 证明：
>
> $k=1$时：
>
> 首先，算法的定义直接保证了跟上一步的共轭关系。因此$k=1$时共轭关系满足。
>
> 精确搜索保证了$$\nabla f(x_1)^Td_0=-\nabla f(x_1)^T\nabla f(x_0)=0,\quad \forall j<k $$
>
> 下面证明当对某个$k-1$成立时，对$k$也成立。
>
> $$ $$




