前面两节分别介绍了下降算法的收敛性定理与下降算法的收敛速度定理。

现在考虑下降方向$d_k$的选取。

- **最速下降法**: 沿负梯度搜索 $d_k=-\nabla f(x_k)$
  - **两点步长法(BB法)**: 在使用最速下降的基础上，步长采用上一步的最佳步长$$\alpha_k=\frac{s_{k-1}^Ty_{k-1}}{\Vert y_{k-1}\Vert^2} \text{或}\frac{\Vert s_{k-1}\Vert^2}{s_{k-1}^Ty_{k-1}} $$
- **Newton法**: 用近似二次函数极小点作为原问题新的近似解。

# Newton法

## Newton法的思想

用近似二次函数极小点作为原问题新的近似解。

对于$f(x)$的Taylor展开，从二次截断。二次近似在$\nabla^2 f(x_k) $正定的情况下，是存在解析的极小点的，即$$\bar{x}=x_k-\nabla^2 f(x_k)^{-1}\nabla f(x_k) $$

只要$\nabla^2 f(x_k)$正定，那么Newton方向就是$f$在$x_k$处的一个下降方向。

上面的方法是古典Newton法。但是为了确保算法的下降性，最后还会加入线性搜索，得到$$\bar{x}=x_k-\alpha_k\nabla^2 f(x_k)^{-1}\nabla f(x_k) $$

> 下降方向为$$d_k=-\nabla^2 f(x_k)\nabla f(x_k) $$，就是方程组$$\nabla^2 f(x_k)d+\nabla f(x_k)=0 $$的解。

> 事实上，对于二次函数的步长，也有解析的最优公式$$\alpha=-\frac{\nabla f(x)^Td}{d^TQd} $$
>
> 这个是容易证明的。

## 二次终止性

Newton法存在**二次终止性**，也就是对一个**严格凸的二次函数极小化问题**，从任何点出发，有限次迭代就可以到达最优点。

对于Newton法，只需要一步迭代就能做到。

> 容易证明的。证明时注意$\alpha$取解析的最优步长。

## 收敛性(非二次函数的全局收敛性)

**定理**

$f$二次连续可微，且存在常数$m>0$，使得$$d^T\nabla^2 f(x)d\geq m\Vert d\Vert^2,\quad \forall d\in R^n,x\in \Omega $$，其中$$\Omega=\{x|f(x)\leq f(x_0) \} $$(也就是上面的条件只要在比$x_0$函数值小的区域内成立就可以了)，那么：
对于由Newton算法产生的序列，步长由精确、Armijo、Wolfe-Powell中任一种产生，都有$x_k\to x^*$

> 证明：
>
> 由定理的条件$$d^T\nabla^2 f(x)d\geq m\Vert d\Vert^2$$就能知道函数是一致凸的。同时，还能有黑塞矩阵在$\Omega$内一致正定。
>
> 这样，函数就有唯一的全局最小值点。
>
> 这里应用之前的定理来证。
>
> 由于需要考虑Armijo也满足，因此需要验证Armijo要求的附加条件也满足。即$$\Vert\nabla f(x)\Vert\leq C\Vert d\Vert $$
>
> 这一点很容易满足，这时因为**所给的区间是一个有限，而函数二次连续可微，在这里黑塞矩阵自然有界**。那么利用牛顿法的下降方向与给出的条件就能得到。事实上，除此以外这个时候还有$$d^T\nabla^2 f(x)d\leq M\Vert d\Vert^2$$
>
> 值得注意的是，这里的$m$与$M$分别可以看作特征值的下界与上界。
>
> 根据这样的性质，又能得到梯度的一致连续性。这样，之前的定理对函数的假设就满足了。
>
> 现在只差最后一步，即保证下降方向与**负**梯度夹角余弦值有正下界即可。(一定注意是负梯度，这个很容易弄错)
>
> 那么最后就能证明，$\cos\theta\leq \frac{M}{C}$，这个是容易的。
>
> 现在补充一个小部分：
>
> 由于黑塞矩阵满足$$m\Vert d\Vert^2\leq d^T\nabla^2 f(x)d\leq M\Vert d\Vert^2 $$，根据这样不等式与特征值的关系，就有$$\frac{1}{M}\Vert d\Vert^2\leq d^T\nabla^2 f(x)^{-1}d\leq \frac{1}{m}\Vert d\Vert^2 $$


## 古典Newton法的局部二次收敛性

**定理**

$f$在$x^*$的某个邻域内二次连续可微且满足$\nabla f(x^*)=0,\nabla^2 f(x^*)$**正定**，则存在常数$\delta>0$，使得当$$x_0\in U_\delta(x^*) $$时，由单位步长法(古典Newton法)产生的序列超线性收敛于$x^*$，此外，若$\nabla^2 f $在$x^*$上Lipschitz连续，那么序列二次收敛于$x^*$

> 证明：
>
> 跟着上一题一样，能够证明其在区间内黑塞矩阵有界，那么就有 $$\Vert\nabla^2 f(x)^{-1}\Vert\leq M $$
> 于是(先代入迭代式然后放缩就有)
> $$\Vert x_{k+1}-x^*\Vert\leq M\Vert \nabla f(x_k)-\nabla f(x^*)-\nabla^2 f(x_k)(x_k-x^*)\Vert $$
>
> 考虑梯度在$x^*$处的展开，就能有$\Vert x_{k+1}-x^*\Vert\leq o(\Vert x_k-x^*\Vert)$
>
> 这样就是超线性收敛了。(不能直接得到二次收敛，因为没有保证更高阶可微，不能用Taylor展式的思想)。
> 在这里，需要利用**将差转化为积分**的思想。
>
> 进一步若满足Lipschitz连续，很容易就能有一个二次收敛。


> 根据上面的定理就能看到，$f$的黑塞矩阵一致正定才能实现Newton法的收敛性。否则可能失效。

# 修正Newton法

$$A_kd_k+\nabla f(x_k)=0 $$解出$d_k$，其中$A_k=\nabla^2 f(x_k)+v_kE $，使得$A_k$正定。

但是$v_k$不能太大。不过没有很好的办法确定其合适的大小。

# Newton-最速下降法

Newton法解出$d_k$后还要判断是否为下降方向，如果不是，就取最速下降方向。

这样的方法就能够有很好的稳定性与较快的收敛速度了。

